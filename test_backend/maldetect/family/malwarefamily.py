from maldetect.family.compute import handler, handlerHash
import hashlib

class MalwareFamily():
    
    def getfamily(self, filepath):
        return handler(filepath)
    
    def getfamily_fromHash(self, sha256):
        return handlerHash(sha256)
    
    def calculate_sha256(self, file_path):
        sha256_hash = hashlib.sha256()
        with open(file_path, "rb") as f:
            for byte_block in iter(lambda: f.read(4096), b""):
                sha256_hash.update(byte_block)
        return sha256_hash.hexdigest()